{
  "version": "2016-05-05",
  "statements": [
    {
      "action": ["GET", "PUT"],
      "resource": [
        "/institution/${user.institutionId}/user/${user.userId}"
      ],
      "restriction": {
        "equals": {
          "userId": "${user.userId}",
          "institutionId": "${user.institutionId}",
          "emailAddress": "${user.emailAddress}"
        }
      }
    },
    {
      "action": ["POST"],
      "resource": [
        "/auth/${user.institutionId}/validate-resource-permissions",
        "/auth/${user.institutionId}/full-service"
      ],
      "restriction": {
        "equals": {
          "userId": "${user.userId}",
          "institutionId": "${user.institutionId}",
          "emailAddress": "${user.emailAddress}"
        }
      }
    },
    {
      "action": ["GET"],
      "resource": [
        "/institution/${user.institutionId}/user/${user.userId}/refresh",
        "/institution/${user.institutionId}/user/${user.userId}/verifyemail"
      ],
      "restriction": {
        "equals": {
          "userId": "${user.userId}",
          "institutionId": "${user.institutionId}",
          "emailAddress": "${user.emailAddress}"
        }
      }
    },
    {
      "action": ["GET", "POST", "PUT"],
      "resource": [
        "/institution/${user.institutionId}/user/${user.userId}/car",
        "/institution/${user.institutionId}/user/${user.userId}/car/*",
        "/institution/${user.institutionId}/user/${user.userId}/quote",
        "/institution/${user.institutionId}/user/${user.userId}/quote/*"
      ],
      "restriction": {
        "equals": {
          "userId": "${user.userId}",
          "institutionId": "${user.institutionId}"
        }
      }
    },
    {
      "action": ["GET"],
      "resource": [
        "/institution/${user.institutionId}/car/bodies",
        "/institution/${user.institutionId}/car/makes",
        "/institution/${user.institutionId}/car/models",
        "/institution/${user.institutionId}/car/styles",
        "/institution/${user.institutionId}/car/vin",
        "/institution/${user.institutionId}/car/vin/*",
        "/institution/${user.institutionId}/car/years"
      ],
      "restriction": {
        "equals": {
          "institutionId": "${user.institutionId}"
        }
      }
    },
    {
      "action": ["GET"],
      "resource": [
        "/institution/${user.institutionId}/car/vin/ocr/drop/${user.userId}",
        "/institution/${user.institutionId}/car/vin/ocr/drop/${user.userId}/*"
      ],
      "restriction": {
        "equals": {
          "userId": "${user.userId}",
          "institutionId": "${user.institutionId}"
        }
      }
    }
  ]
}
